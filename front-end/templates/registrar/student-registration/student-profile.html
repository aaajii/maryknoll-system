{% extends 'base.html' %}
{%block title%} Admin Settings {%endblock%}
{% block settings %}
<li class="nav-item active">
    <a class="nav-link" href="{% url 'settings' %}">Settings
        <span class="sr-only">(current)</span>
    </a>
</li>
{% endblock %} {%load static%} {% block content %}

      <div class="seal"></div>
      <div class="row">
        <!--<div class="col-md-6">
          <a href="student-registration-list.html" class="no-print">
            <h4><i class="fa fa-angle-left" aria-hidden="true"></i> Back to records list</h4>
          </a>
        </div>-->
        <div class="col-md-6 no-print">
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
              <li class="breadcrumb-item"><a href="{%url 'dashboard' %}">Home</a></li>
              <li class="breadcrumb-item"><a href="{%url 'student-list' %}">Student Profiles</a></li>
              <li class="breadcrumb-item active" aria-current="page">{{student.first_name}} {{student.middle_name}} {{student.last_name}}</li>
            </ol>
          </nav>
        </div>      
      </div>
      <div class="card container">
          <div class="card-block inner ">
          <div class="row">
            <div class="col-md-12">
              <div class="row menu-flex">
                <div class="col-md-8">
                  <h1 class="card-title">{{student.first_name}} {{student.middle_name}} {{student.last_name}}</h1>
                </div>
                <div class="col-md-4 line-break no-print">
                  <a href="javascript:window.print()" class="card-link btn btn-outline-primary line-break-child"><i class="fa fa-print" aria-hidden="true"></i> Print Student Profile</a>
                  <!--a href="{% url 'student-update' student.student_ID %}" class="btn btn-secondary view-button">Edit</a></td-->
                </div>
              </div>
              <div class="row">
                <div class="col-sm-4">
                  <h6 class="card-subtitle mb-2 link">Student ID: <span class="text-muted">{{student.student_ID}}</span></h6>
                  <h6 class="card-subtitle link mb-2 ">Student Level:<span class="text-muted"> {{student.get_student_level_display}}</span></h6>
                  <h6 class="card-subtitle link mb-2 ">Year Level/Section:<span class="text-muted"> {# current section #}</span></h6>
                  <h6 class="card-subtitle mb-2 link">Place of Birth: <span class=" text-muted">{{student.birthplace}}</span></h6>
                  <h6 class="card-subtitle link mb-2 ">Date of Birth: <span class="text-muted">{{student.birthdate}}</span></h6>
                </div>
                <div class="col-sm-4 no-print">
                  <h6 class="card-subtitle link mb-2 ">Sex: <span class="text-muted"> {{student.get_gender_display}}</span></h6>
                  <h6 class="card-subtitle link mb-2 ">Home Address: <span class="text-muted"> {{student.home_addr}}</span></h6>
                  <h6 class="card-subtitle link mb-2 ">Postal Address: <span class="text-muted"> {{student.postal_addr}}</span></h6>
                </div>
                <div class="col-md-4 no-print">
                  <h6 class="card-subtitle link mb-2 ">Father's Name: <span class="text-muted"> {{student.f_firstname}} {{student.f_lastname}}</span></h6>
                  <h6 class="card-subtitle link mb-2 ">Mother's Name: <span class="text-muted"> {{student.m_firstname}} {{student.m_lastname}}</span></h6>
                  <h6 class="card-subtitle link mb-2 ">Guardian's Name: <span class="text-muted"> {{student.guardian}}</span></h6>
                </div>
              </div>
            </div>
          </div>
          <div class="row table-records table-responsive">
            <ul class="nav nav-tabs no-print">
              <li class="nav-item">
                <a class="nav-link active" data-toggle="tab" href="#studentRegis">Registration</a>
              </li>
              {% if record %}
              <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#studentAcc">Financial Records</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#studentClasses">Subjects</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#studentLedger">Payment Logs</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#studentScholarships">Scholarships</a>
              </li>
              {% endif %}
            </ul>
            <div class="tab-content">
              <!-- STUDENT REGISTRATION -->
              <div class="tab-pane active container" id="studentRegis">
                <div class="row records">
                  <div class="col-md-8 no-print">
                    <h2>Student Registration</h2>
                  </div>
                  <div class="col-md-4">
                    <div class="btn-group float-right no-print">
                      <a href="{% url 'enrollment-add' student.student_ID%}" class="add-button btn btn-primary "><i class="fa fa-plus" aria-hidden="true"></i> Create Student Registration</a>
                    </div>
                  </div>
                </div>
                <div class="row table-records table-responsive enrollment-table">
                  REGISTRATION LIST GOES HERE
                </div>
              </div>
              <!-- STUDENT REGISTRATION -->
              <!-- FINANCIAL RECORDS -->
              <div class="tab-pane container financial-table" id="studentAcc">
                  
              </div>
              <!-- FINANCIAL RECORDS -->
              <!-- SUBJECTS TAKEN -->
              <div class="tab-pane container" id="studentClasses">
                <div class="row records">
                  <div class="col-md-8 no-print">
                    <h2>Subjects</h2>
                  </div>
                  <div class="col-md-4">
                    <div class="btn-group float-right no-print">
                      {%if record%}
                      <a href="{% url 'subjectOffering-list' record.school_year.pk %}" class="add-button btn btn-primary "><i class="fa fa-plus" aria-hidden="true"></i> View Offerings</a>
                      {% endif %}
                    </div>
                  </div>
                </div>
                <div class="row table-records table-responsive subjects-table">
                  
                </div>
              </div>
              <div class="tab-pane container" id="studentLedger">
                  <div class="row records">
                      <div class="col-md-8 no-print">
                          <h2>Transaction Logs</h2>
                      </div>
                      <div class="col-md-4">
                          <div class="btn-group float-right no-print">
                              {% if record %}
                                <a href="{% url 'transaction' record.enrollment_ID %}" class="add-button btn btn-primary "><i class="fa fa-plus" aria-hidden="true"></i> Create New Transaction</a>
                              {% endif %}
                          </div>
                      </div>
                      
                      <div class="row table-records table-responsive ledger-table">
                      </div>    
                  </div>
                </div>
              <div class="tab-pane container" id="studentScholarships">
                <div class="row records">
                  <div class="col-md-8 no-print">
                    <h2>Scholarships</h2>
                  </div>
                  <div class="col-md-4">
                    <div class="btn-group float-right no-print">
                      {% if record %}
                      <a href="{% url 'student-scholars-add' record.enrollment_ID %}" class="add-button btn btn-primary "><i class="fa fa-plus" aria-hidden="true"></i> Add Scholarship</a>
                      {% else %}
                      <a href="#" class="add-button btn btn-primary "><i class="fa fa-plus" aria-hidden="true"></i> Add Scholarship</a>
                      {% endif %}
                      
                    </div>
                  </div>
                </div>
                <div class="row table-records table-responsive scholarship-table">
                  
                </div>
              </div>
            </div>
          </div>
        </div>
  <!-- CONTENT -->
 

<script type="text/javascript">
  function deleteRow(obj, num){
    $(obj).closest('tr').remove();
    $.ajax({
      url: '{% url "delete-scholar" %}?scholar='+num,
      type: 'get',
      dataType: 'json',
      success: function(data) {
        generateScholarTable();
      }
    });
  }
</script>


{#---------------------------BACKEND SCRIPTS -------------------------------#}

<script>
  $(function() {
    generateStudentTable();
    {% if record %}
      generateScholarTable();
      generateTransactionTable();
      generateFinancialRecords();
      generateSubjectsTable();
    {% endif %}
    
  });
  {% if record.section %}
    function generateSubjectsTable(){
      $.ajax({
        url: '{% url "subjects-table" record.section.section_ID %}',
        type: 'get',
        dataType: 'json',
        success: function(data) {
          $(".subjects-table").html(data.html_form);
        }
      });
    }
  {% endif %}
  {% if record %} 
    function generateTransactionTable(){
      $.ajax({
        url: '{% url "transaction-history" record.enrollment_ID %}',
        type: 'get',
        dataType: 'json',
        success: function(data) {
          $(".ledger-table").html(data.html_form);
        }
      });
    }
  {% endif %}
  

  function generateStudentTable(){
    
    $.ajax({
      url: '{% url "enrollment-table" student.student_ID %}',
      type: 'get',
      dataType: 'json',
      success: function(data) {
        $(".enrollment-table").html(data.html_form);
      }
    });
  }

  {% if record %}
  function generateScholarTable(){
    $.ajax({
      url: '{% url "student-scholars-table" record.enrollment_ID %}',
      type: 'get',
      dataType: 'json',
      success: function(data) {
        $(".scholarship-table").html(data.html_form);
        generateStudentTable();
      }
    });
  }
  {%endif%}
  {% if record %}
  function generateFinancialRecords(){
    $.ajax({
      url: '{% url "financial-records" record.enrollment_ID %}',
      type: 'get',
      dataType: 'json',
      success: function(data) {
        $(".financial-table").html(data.html_form);
        generateStudentTable();
      }
    });
  }
  {%endif%}
</script>
{%endblock%}
